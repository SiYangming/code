---
title: "pima-indians-diabetes"
output: html_notebook
---

# 测试集和训练集验证

```{python}
# train-test split evaluation of xgboost model
from numpy import loadtxt  
from xgboost import XGBClassifier  
from sklearn.model_selection import train_test_split  
from sklearn.metrics import accuracy_score  
# load data  
dataset = loadtxt('https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv', delimiter=",")  
# split data into X and y  
X = dataset[:,0:8]  
Y = dataset[:,8]  
# split data into train and test sets  
X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.33, random_state=7) # fit model on training data  
model = XGBClassifier() 
model.fit(X_train, y_train) 
```


```{python}
# make predictions for test data  
predictions = model.predict(X_test)  
# evaluate predictions  
accuracy = accuracy_score(y_test, predictions)  
print("Accuracy: %.2f%%" % (accuracy * 100.0))
```

# K-Fold交叉验证

```{python}
# k-fold cross validation evaluation of xgboost model
from numpy import loadtxt  
from xgboost import XGBClassifier  
from sklearn.model_selection import KFold  
from sklearn.model_selection import cross_val_score  
# load data  
dataset = loadtxt('https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv', delimiter=",")  
# split data into X and y  
X = dataset[:,0:8]  
Y = dataset[:,8]  
# CV model  
model = XGBClassifier()  
# kfold = KFold(n_splits=10, random_state=7)
kfold = KFold(n_splits=10, shuffle=True)
results = cross_val_score(model, X, Y, cv=kfold)  
print("Accuracy: %.2f%% (%.2f%%)" % (results.mean()*100, results.std()*100))
```

# 不平衡数据

```{python}
# stratified k-fold cross validation evaluation of xgboost model
from numpy import loadtxt  
from xgboost import XGBClassifier  
from sklearn.model_selection import StratifiedKFold  
from sklearn.model_selection import cross_val_score  
# load data  
dataset = loadtxt('https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv', delimiter=",")  
# split data into X and y  
X = dataset[:,0:8]  
Y = dataset[:,8]  
# CV model  
model = XGBClassifier()  
kfold = StratifiedKFold(n_splits=10)  
results = cross_val_score(model, X, Y, cv=kfold)  
print("Accuracy: %.2f%% (%.2f%%)" % (results.mean()*100, results.std()*100))
```

